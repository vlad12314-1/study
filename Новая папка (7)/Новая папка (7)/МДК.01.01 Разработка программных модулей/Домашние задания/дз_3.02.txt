Пользовательские виджеты
Определение (02)
Пользовательский виджет — класс, унаследованный от QWidget (или другого виджета), который

Объединяет несколько стандартных элементов

Ведёт себя как один логический компонент интерфейса

Для чего нужны (03)
Без пользовательских виджетов

Код разрастается

Интерфейс невозможно читать

Много копирования кода (copy-paste everywhere)

Любое изменение ломает всё

С пользовательскими виджетами

Интерфейс собирается из «кубиков» (компонентов)

Код становится читаемым

Возможно повторное использование

Меньше проблем при внесении изменений

Пример (04)
Пример формы

Имя

Email

Кнопка Сохранить

Без пользовательского виджета элементы размазаны по окну, сложно управлять
С пользовательским виджетом создается UserFormWidget, внутри которого все элементы, а снаружи — аккуратный компактный компонент

Базовая идея (05)
Стандартный шаблон пользовательского виджета

Внешний код не знает, что происходит внутри виджета

Внешний код просто добавляет виджет как обычный QWidget

Логика пользовательского виджета (06)
Снаружи виджета

Используются методы addWidget()

Доступны публичные методы

Отправляются сигналы

Внутри виджета

Содержатся кнопки, поля ввода

Реализована внутренняя логика

Обрабатываются события

Происходит GUI-инкапсуляция

Пример виджет «Карточка рецепта» (07)
Характеристики хорошего виджета

Принимает данные для отображения

Отображает эти данные

Не работает с базой данных напрямую

Не знает о файловой системе

Просто показывает информацию

Взаимодействие с GUI (08)
Конечный пользователь не знает о внутренней реализации виджета

Виджет используется как чёрный ящик

Методы пользовательского виджета (09)
Хороший виджет

Имеет публичные методы для взаимодействия

Не требует лазания во внутреннюю реализацию

Хороший способ Использование публичных методов
Плохой способ Прямой доступ к внутренним элементам

Пользовательские сигналы (10)
Виджет должен

Сообщать наружу о событиях

Не управлять логикой приложения

Примеры событий

Нажатие кнопки внутри виджета

Выбор элемента

Изменение значения

Принцип работы Виджет генерирует сигнал, но не знает, кто его обработает

Когда нужно создавать пользовательский виджет (11)
Обязательно создавать, если

Элемент повторяется в интерфейсе

Виджет сложнее одной кнопки

Есть внутренняя логика работы

Хочется поддерживать чистый код

Не обязательно создавать, если

Это одна простая кнопка

Это одно поле ввода

Компонент используется один раз и не будет расширяться

Ключевые принципы
Инкапсуляция GUI — скрытие внутренней реализации

Повторное использование — компонентный подход

Чистый код — улучшение читаемости и поддержки

Слабая связность — виджет не зависит от логики приложения

Сигнально-слотовый механизм — для взаимодействия с внешним миром